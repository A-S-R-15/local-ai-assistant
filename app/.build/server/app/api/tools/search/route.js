"use strict";(()=>{var e={};e.id=237,e.ids=[237],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1488:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>w,patchFetch:()=>S,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>d,staticGenerationAsyncStorage:()=>m});var r={};s.r(r),s.d(r,{GET:()=>l,POST:()=>p,dynamic:()=>u});var a=s(921),n=s(7380),o=s(4185),i=s(3878),c=s(4717);let u="force-dynamic";async function l(e){try{let{searchParams:t}=new URL(e.url),s=t.get("q")||t.get("query");if(!s)return i.NextResponse.json({success:!1,error:"Query parameter is required"},{status:400});let r={engine:t.get("engine")||"duckduckgo",num:parseInt(t.get("num")||"10"),location:t.get("location")||void 0,language:t.get("language")||void 0},a=await c.P.search(s,r);return i.NextResponse.json({success:!0,data:a,timestamp:new Date().toISOString()})}catch(e){return console.error("Search tool error:",e),i.NextResponse.json({success:!1,error:"Failed to perform search",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function p(e){try{let t;let{query:s,action:r="search",options:a={}}=await e.json();if(!s)return i.NextResponse.json({success:!1,error:"Query is required"},{status:400});switch(r){case"search":t=await c.P.search(s,a);break;case"searchNews":t=await c.P.searchNews(s,a);break;case"searchImages":t=await c.P.searchImages(s,a);break;default:return i.NextResponse.json({success:!1,error:"Invalid action"},{status:400})}return i.NextResponse.json({success:!0,data:t,timestamp:new Date().toISOString()})}catch(e){return console.error("Search tool POST error:",e),i.NextResponse.json({success:!1,error:"Failed to process search request",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/tools/search/route",pathname:"/api/tools/search",filename:"route",bundlePath:"app/api/tools/search/route"},resolvedPagePath:"/home/ubuntu/local_ai_assistant_v3/app/app/api/tools/search/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:d}=h,w="/api/tools/search/route";function S(){return(0,o.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:m})}},4717:(e,t,s)=>{s.d(t,{P:()=>r});class r{static{this.serpApiKey=null}static{this.baseUrl="https://serpapi.com/search"}static setApiKey(e){this.serpApiKey=e}static async search(e,t={}){let s=Date.now();return this.serpApiKey?this.searchWithSerpApi(e,t,s):this.searchWithFallback(e,t,s)}static async searchWithSerpApi(e,t,s){try{let r=new URLSearchParams({q:e,api_key:this.serpApiKey,engine:t.engine||"google",num:(t.num||10).toString(),...t.location&&{location:t.location},...t.language&&{hl:t.language}}),a=await fetch(`${this.baseUrl}?${r}`);if(!a.ok)throw Error(`Search API error: ${a.statusText}`);let n=await a.json(),o=Date.now()-s,i=(n.organic_results||[]).map(e=>({title:e.title,url:e.link,snippet:e.snippet,source:new URL(e.link).hostname,timestamp:e.date}));return{query:e,results:i,totalResults:n.search_information?.total_results||i.length,searchTime:o,suggestions:n.related_searches?.map(e=>e.query)||[]}}catch(r){return console.error("SerpAPI search error:",r),this.searchWithFallback(e,t,s)}}static async searchWithFallback(e,t,s){try{let t=await fetch(`https://api.duckduckgo.com/?q=${encodeURIComponent(e)}&format=json&no_html=1&skip_disambig=1`,{signal:AbortSignal.timeout(1e4)});if(t.ok){let r=await t.json(),a=Date.now()-s,n=[];if(r.AbstractText&&n.push({title:r.Heading||e,url:r.AbstractURL||"",snippet:r.AbstractText,source:"DuckDuckGo",timestamp:new Date().toISOString()}),r.RelatedTopics&&r.RelatedTopics.slice(0,5).forEach(e=>{e.Text&&e.FirstURL&&n.push({title:e.Text.split(" - ")[0],url:e.FirstURL,snippet:e.Text,source:"DuckDuckGo",timestamp:new Date().toISOString()})}),n.length>0)return{query:e,results:n,totalResults:n.length,searchTime:a,suggestions:[]}}}catch(e){console.error("DuckDuckGo search error:",e)}try{let t=await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(e)}`,{signal:AbortSignal.timeout(8e3)});if(t.ok){let r=await t.json(),a=Date.now()-s;if(r.extract)return{query:e,results:[{title:r.title,url:r.content_urls?.desktop?.page||"",snippet:r.extract,source:"Wikipedia",timestamp:new Date().toISOString()}],totalResults:1,searchTime:a,suggestions:[]}}}catch(e){console.error("Wikipedia search error:",e)}try{let t=Date.now()-s,r=this.generateContextualResults(e);return{query:e,results:r,totalResults:r.length,searchTime:t,suggestions:this.generateSearchSuggestions(e)}}catch(e){console.error("Contextual search error:",e)}return this.getMockSearchResults(e,s)}static generateContextualResults(e){let t=e.toLowerCase(),s=[];return(t.includes("time")||t.includes("date")||t.includes("today"))&&s.push({title:"Current Time and Date Information",url:"https://time.is",snippet:`Current time: ${new Date().toLocaleString()}. For more precise time information, use the time tool in this assistant.`,source:"Time Service",timestamp:new Date().toISOString()}),(t.includes("weather")||t.includes("temperature")||t.includes("forecast"))&&s.push({title:"Weather Information",url:"https://weather.com",snippet:"For current weather information, use the weather tool in this assistant. Provide a location to get real-time weather data.",source:"Weather Service",timestamp:new Date().toISOString()}),(t.includes("programming")||t.includes("code")||t.includes("javascript")||t.includes("python"))&&s.push({title:"Programming and Development Resources",url:"https://developer.mozilla.org",snippet:"Find comprehensive programming documentation, tutorials, and examples. This assistant can also help with code questions directly.",source:"Developer Resources",timestamp:new Date().toISOString()}),(t.includes("news")||t.includes("latest")||t.includes("current events"))&&s.push({title:"Latest News and Current Events",url:"https://news.google.com",snippet:"For the most current news, visit major news websites. Note: This assistant provides general information but may not have the very latest breaking news.",source:"News Aggregator",timestamp:new Date().toISOString()}),0===s.length&&s.push({title:`Search Results for "${e}"`,url:"https://duckduckgo.com/?q="+encodeURIComponent(e),snippet:"For comprehensive web search results, try searching on DuckDuckGo, Google, or other search engines. This assistant can help answer questions directly.",source:"Search Guidance",timestamp:new Date().toISOString()}),s}static generateSearchSuggestions(e){return[`${e} tutorial`,`${e} guide`,`${e} examples`,`what is ${e}`,`how to ${e}`,`${e} 2024`].slice(0,3)}static getMockSearchResults(e,t){let s=Date.now()-t;return{query:e,results:[{title:`Search results for "${e}"`,url:"https://example.com",snippet:"Search functionality is currently in development. Please configure a search API key for full functionality.",source:"Local Assistant",timestamp:new Date().toISOString()}],totalResults:1,searchTime:s,suggestions:[`${e} tutorial`,`${e} guide`,`${e} examples`]}}static async searchNews(e,t={}){return this.search(`${e} news`,{...t,engine:"google"})}static async searchImages(e,t={}){return this.search(`${e} images`,{...t,engine:"google"})}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[923,146],()=>s(1488));module.exports=r})();